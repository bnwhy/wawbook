import React, { useEffect, useState } from 'react';

interface PaymentBadgesProps {
  size?: 'small' | 'medium' | 'large';
  className?: string;
}

const PaymentBadges: React.FC<PaymentBadgesProps> = ({ size = 'medium', className = '' }) => {
  const [acceptedMethods, setAcceptedMethods] = useState<string[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchPaymentMethods = async () => {
      try {
        const response = await fetch('/api/settings/payment');
        if (response.ok) {
          const data = await response.json();
          setAcceptedMethods(data.value?.acceptedPaymentMethods || []);
        }
      } catch (error) {
        console.error('Erreur lors du chargement des m√©thodes de paiement:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchPaymentMethods();
  }, []);

  const sizeConfig = {
    small: { height: '32px', padding: '6px 10px' },
    medium: { height: '44px', padding: '8px 14px' },
    large: { height: '56px', padding: '10px 18px' }
  };

  const config = sizeConfig[size];
  const logoHeight = size === 'small' ? '20px' : size === 'medium' ? '28px' : '36px';

  // Logos avec couleurs officielles - SVG inline
  const paymentLogos: Record<string, JSX.Element> = {
    visa: (
      <svg viewBox="0 0 141.732 141.732" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <g fill="#1A1F71">
          <path d="M62.935 89.571h-9.733l6.083-37.384h9.734z"/>
          <path d="M45.014 52.187l-9.279 25.713-1.098-5.537.001.002-3.275-16.812s-.396-3.366-4.617-3.366h-15.34l-.18.633s4.691.976 10.181 4.273l8.456 32.479h10.141l15.485-37.385H45.014z"/>
          <path d="M121.569 89.571h8.937l-7.792-37.385h-7.824c-3.613 0-4.493 2.786-4.493 2.786l-14.516 34.599h10.146l2.029-5.553h12.373l1.14 5.553zm-10.71-13.224l5.114-13.99 2.877 13.99h-7.991z"/>
          <path d="M96.642 61.177l1.389-8.028s-4.286-1.63-8.754-1.63c-4.83 0-16.3 2.111-16.3 12.376 0 9.658 13.462 9.778 13.462 14.851s-12.075 4.164-16.06.965l-1.447 8.394s4.346 2.111 10.986 2.111c6.642 0 16.662-3.439 16.662-12.799 0-9.72-13.583-10.625-13.583-14.851.001-4.227 9.48-3.684 13.645-1.389z"/>
        </g>
      </svg>
    ),
    mastercard: (
      <svg viewBox="0 0 131.39 86.9" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <rect fill="#FF5F00" x="48.37" y="15.14" width="34.66" height="56.61"/>
        <path fill="#EB001B" d="M51.94,43.45a35.94,35.94,0,0,1,13.75-28.3,36,36,0,1,0,0,56.61A35.94,35.94,0,0,1,51.94,43.45Z"/>
        <path fill="#F79E1B" d="M123.94,43.45a36,36,0,0,1-58.25,28.3,36,36,0,0,0,0-56.61,36,36,0,0,1,58.25,28.3Z"/>
      </svg>
    ),
    amex: (
      <svg viewBox="0 0 141.732 141.732" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <g fill="#006FCF">
          <path d="M89.598 33.566h-33.82l-7.68 17.921-7.923-17.921H6.325v53.509h32.598l7.802-18.004 7.921 18.004h33.823l-11.155-26.756 11.155-26.753h.129z"/>
          <path d="M19.881 74.62V46.021h9.614l7.803 17.921V46.021h10.129l6.837 15.466 6.328-15.466h10.251v28.599h-6.201V51.815L56.302 74.62h-5.075L42.76 51.815V74.62H19.881z"/>
          <path d="M94.766 74.62L88.67 60.858l-6.096 13.762H63.25l11.645-26.753-11.645-26.753h19.324l6.096 13.883 6.096-13.883h19.203L102.324 47.867 114.09 74.62H94.766z"/>
          <path d="M122.014 46.021v6.449h13.518v6.328h-13.518v6.571h15.102v9.251h-21.424V46.021h21.424v-.121h-15.102v.121z"/>
        </g>
      </svg>
    ),
    discover: (
      <svg viewBox="0 0 780 501" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <path fill="#FF6000" d="M54,0h672c29.8,0,54,24.2,54,54v393c0,29.8-24.2,54-54,54H54c-29.8,0-54-24.2-54-54V54C0,24.2,24.2,0,54,0z"/>
        <g fill="#231F20">
          <path d="M184.1,269.3c-3.2,0-5.8-0.9-7.8-2.6c-2-1.7-3-4.2-3-7.3v-45.2h11.3v44.6c0,0.7,0.2,1.3,0.5,1.7c0.4,0.4,0.9,0.6,1.6,0.6h4.7v8.2H184.1z"/>
          <path d="M234.7,269.3c-6.5,0-11.8-2-15.8-5.9c-4-4-6-9.3-6-16v-13.2c0-6.7,2-12,6-16c4-4,9.3-5.9,15.8-5.9c6.5,0,11.8,2,15.8,5.9c4,4,6,9.3,6,16v13.2c0,6.7-2,12-6,16C246.5,267.3,241.2,269.3,234.7,269.3z M234.7,261.1c2.3,0,4.1-0.8,5.4-2.5c1.3-1.6,2-3.9,2-6.9v-13.2c0-3-0.7-5.3-2-6.9c-1.3-1.6-3.1-2.5-5.4-2.5c-2.3,0-4.1,0.8-5.4,2.5c-1.3,1.6-2,3.9-2,6.9v13.2c0,3,0.7,5.3,2,6.9C230.6,260.3,232.4,261.1,234.7,261.1z"/>
        </g>
      </svg>
    ),
    applepay: (
      <svg viewBox="0 0 165.521 105.965" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <path fill="#000" d="M150.698 0H14.823C6.636 0 0 6.636 0 14.823v76.318c0 8.187 6.636 14.824 14.823 14.824h135.875c8.187 0 14.823-6.637 14.823-14.824V14.823C165.521 6.636 158.885 0 150.698 0z"/>
        <g fill="#FFF">
          <path d="M30.958 26.779c1.454-1.889 2.448-4.495 2.178-7.104-2.107.084-4.66 1.395-6.171 3.166-1.343 1.547-2.517 4.052-2.202 6.441 2.329.177 4.707-1.172 6.195-2.503z"/>
          <path d="M33.116 30.155c-3.438-.201-6.363 1.941-7.988 1.941-1.625 0-4.134-1.835-6.805-1.785-3.497.05-6.724 2.009-8.522 5.122-3.627 6.243-1.006 15.518 2.602 20.596 1.77 2.491 3.867 5.276 6.64 5.174 2.622-.102 3.615-1.688 6.789-1.688s4.017 1.688 6.789 1.638c2.826-.053 4.668-2.509 6.438-5 2.004-2.877 2.826-5.652 2.876-5.801-.063-.025-5.515-2.106-5.565-8.35-.05-5.222 4.276-7.728 4.476-7.855-2.436-3.552-6.236-3.953-7.578-4.042l-.152.05z"/>
          <path d="M54.8 24.129v31.588h4.885v-10.81h6.767c6.186 0 10.532-4.219 10.532-10.393s-4.297-10.385-10.434-10.385H54.8z"/>
          <path d="M59.685 28.172h5.638c4.247 0 6.668 2.253 6.668 6.35s-2.421 6.36-6.676 6.36h-5.63V28.172z"/>
          <path d="M96.347 50.108c3.046 0 5.859-1.521 7.136-3.938h.1v3.717h4.543V37.224c0-4.446-3.569-7.299-9.04-7.299-5.055 0-8.82 2.903-8.97 6.873h4.394c.349-1.87 2.053-3.092 4.444-3.092 2.893 0 4.494 1.322 4.494 3.741v1.64l-5.863.347c-5.458.325-8.406 2.524-8.406 6.344 0 3.869 2.998 6.42 7.168 6.42z"/>
          <path d="M97.569 46.517c-2.492 0-4.095-1.195-4.095-3.017 0-1.872 1.553-2.968 4.494-3.143l5.264-.3v1.57c0 2.616-2.219 4.89-5.663 4.89z"/>
          <path d="M114.704 27.002c0-2.84 2.352-4.662 5.862-4.662 3.362 0 5.63 1.723 5.73 4.413h4.494c-.1-4.738-4.196-8.181-10.257-8.181-6.086 0-10.332 3.443-10.332 8.156 0 3.992 2.867 6.293 8.02 7.514l3.144.699c3.045.674 4.494 1.572 4.494 3.118 0 1.821-1.996 3.243-5.405 3.243-3.611 0-5.913-1.622-6.187-4.338h-4.643c.225 4.863 4.345 8.33 10.83 8.33 6.487 0 10.83-3.368 10.83-8.48 0-3.943-2.793-6.194-7.996-7.416l-3.693-.799c-2.643-.624-4.096-1.497-4.096-3.018z"/>
        </g>
      </svg>
    ),
    googlepay: (
      <svg viewBox="0 0 122.88 37.28" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <path fill="#5F6368" d="M35.52 16.64v11.68h-2.97V2.2h7.9c3.13 0 5.79.99 7.8 2.96 2.02 1.98 3.03 4.44 3.03 7.38s-1.01 5.4-3.03 7.38c-2.01 1.97-4.67 2.96-7.8 2.96h-4.93v-5.24zm0-11.97v9.5h4.97c1.79 0 3.29-.62 4.5-1.86 1.21-1.24 1.82-2.77 1.82-4.59s-.61-3.35-1.82-4.59c-1.21-1.24-2.71-1.86-4.5-1.86h-4.97v3.4zm19.24 23.61c-1.64 0-3.06-.42-4.27-1.27-1.21-.85-2.15-2.01-2.82-3.49-.67-1.48-1-3.13-1-4.96v-.32c0-1.83.33-3.48 1-4.96.67-1.48 1.61-2.64 2.82-3.49 1.21-.85 2.63-1.27 4.27-1.27 1.64 0 3.06.42 4.27 1.27 1.21.85 2.15 2.01 2.82 3.49.67 1.48 1 3.13 1 4.96v.32c0 1.83-.33 3.48-1 4.96-.67 1.48-1.61 2.64-2.82 3.49-1.21.85-2.63 1.27-4.27 1.27zm-.37-11.16c-.87 0-1.61.32-2.23 0.96-.62.64-.93 1.49-.93 2.55v.23c0 1.06.31 1.91.93 2.55.62.64 1.36.96 2.23.96s1.61-.32 2.23-.96c.62-.64.93-1.49.93-2.55v-.23c0-1.06-.31-1.91-.93-2.55-.62-.64-1.36-.96-2.23-.96zm13.07 6.93l3.78-10.78h3.17L68.98 28.6c-.95 2.37-2.26 3.55-3.93 3.55-.55 0-1.09-.11-1.62-.32v-2.45c.38.17.79.26 1.24.26.7 0 1.25-.27 1.64-.81.39-.54.74-1.21 1.04-2.01l.36-.9-5.04-13.92h3.2l3.2 10.78h.01z"/>
        <path fill="#4285F4" d="M12 14.4c0-.63-.06-1.24-.16-1.83H.2V16.6h6.63c-.29 1.5-1.14 2.78-2.44 3.62v3.02h3.95c2.31-2.13 3.65-5.27 3.65-8.85h.01z"/>
        <path fill="#34A853" d="M.2 24.4c3.29 0 6.05-1.09 8.07-2.96l-3.95-3.07c-1.09.73-2.48 1.16-4.12 1.16-3.17 0-5.85-2.14-6.81-5.02H-10.64v3.13c2.01 3.99 6.14 6.72 10.84 6.72z"/>
        <path fill="#FBBC04" d="M-6.61 14.51c-.25-.73-.38-1.5-.38-2.31s.14-1.58.38-2.31V6.76h-4.03c-1.35 2.7-1.35 5.88 0 8.58l4.03-3.13v.3z"/>
        <path fill="#EA4335" d="M.2 3.67c1.79 0 3.39.61 4.65 1.82l3.49-3.49C6.24.14 3.49-1 .2-1c-4.7 0-8.83 2.73-10.84 6.72l4.03 3.13c.96-2.88 3.64-5.02 6.81-5.02v-.16z"/>
      </svg>
    ),
    paypal: (
      <svg viewBox="0 0 124 33" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <path fill="#003087" d="M46.211 6.749h-6.839a.95.95 0 0 0-.939.802l-2.766 17.537a.57.57 0 0 0 .564.658h3.265a.95.95 0 0 0 .939-.803l.746-4.73a.95.95 0 0 1 .938-.803h2.165c4.505 0 7.105-2.18 7.784-6.5.306-1.89.013-3.375-.872-4.415-.972-1.142-2.696-1.746-4.985-1.746zm.789 6.405c-.374 2.454-2.249 2.454-4.062 2.454h-1.032l.724-4.583a.57.57 0 0 1 .563-.481h.473c1.235 0 2.4 0 3.002.704.359.42.469 1.044.332 1.906z"/>
        <path fill="#009cde" d="M66.654 13.075h-3.275a.57.57 0 0 0-.563.481l-.145.916-.229-.332c-.709-1.029-2.29-1.373-3.868-1.373-3.619 0-6.71 2.741-7.312 6.586-.313 1.918.132 3.752 1.22 5.031.998 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .562.66h2.95a.95.95 0 0 0 .939-.803l1.77-11.209a.568.568 0 0 0-.561-.658zm-4.565 6.374c-.316 1.871-1.801 3.127-3.695 3.127-.951 0-1.711-.305-2.199-.883-.484-.574-.668-1.391-.514-2.301.295-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.499.589.697 1.411.554 2.317z"/>
        <path fill="#003087" d="M94.992 6.749h-6.84a.95.95 0 0 0-.938.802l-2.766 17.537a.569.569 0 0 0 .562.658h3.51a.665.665 0 0 0 .656-.562l.785-4.971a.95.95 0 0 1 .938-.803h2.164c4.506 0 7.105-2.18 7.785-6.5.307-1.89.012-3.375-.873-4.415-.971-1.142-2.694-1.746-4.983-1.746zm.789 6.405c-.373 2.454-2.248 2.454-4.062 2.454h-1.031l.725-4.583a.568.568 0 0 1 .562-.481h.473c1.234 0 2.4 0 3.002.704.359.42.468 1.044.331 1.906z"/>
        <path fill="#009cde" d="M115.434 13.075h-3.273a.567.567 0 0 0-.562.481l-.145.916-.23-.332c-.709-1.029-2.289-1.373-3.867-1.373-3.619 0-6.709 2.741-7.311 6.586-.312 1.918.131 3.752 1.219 5.031 1 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .564.66h2.949a.95.95 0 0 0 .938-.803l1.771-11.209a.571.571 0 0 0-.565-.658zm-4.565 6.374c-.314 1.871-1.801 3.127-3.695 3.127-.949 0-1.711-.305-2.199-.883-.484-.574-.666-1.391-.514-2.301.297-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.501.589.699 1.411.554 2.317z"/>
        <path fill="#003087" d="M119.295 7.23l-2.807 17.858a.569.569 0 0 0 .562.658h2.822c.469 0 .867-.34.939-.803l2.768-17.536a.57.57 0 0 0-.562-.659h-3.16a.571.571 0 0 0-.562.482z"/>
      </svg>
    ),
    klarna: (
      <svg viewBox="0 0 200 100" height={logoHeight} xmlns="http://www.w3.org/2000/svg">
        <path fill="#FFB3C7" d="M30 20h15v60H30zm45 0h15v25c5-6 12-10 20-10 15 0 27 12 27 27v28h-15V62c0-7-5-12-12-12s-12 5-12 12v18H73V20zm55 0h15v60h-15zm23 0h15l15 20 10-13L138 8h15l-20 28 20 32h-16l-12-18-11 18h-16l20-32z"/>
      </svg>
    )
  };

  if (loading) {
    return (
      <div className={`flex items-center justify-center gap-3 ${className}`}>
        <div className="animate-pulse flex gap-3">
          {[1, 2, 3, 4, 5].map(i => (
            <div
              key={i}
              className="bg-gray-200 rounded"
              style={{ height: config.height, width: '60px' }}
            ></div>
          ))}
        </div>
      </div>
    );
  }

  if (acceptedMethods.length === 0) {
    return null;
  }

  return (
    <div className={`flex items-center justify-center flex-wrap gap-3 ${className}`}>
      {acceptedMethods.map(method => {
        const logo = paymentLogos[method];
        if (!logo) return null;
        
        return (
          <div
            key={method}
            className="inline-flex items-center justify-center rounded shadow-sm transition-transform hover:scale-105"
            style={{
              height: config.height,
              padding: config.padding,
              backgroundColor: '#FFFFFF',
              border: '1px solid #E5E7EB'
            }}
          >
            {logo}
          </div>
        );
      })}
    </div>
  );
};

export default PaymentBadges;
